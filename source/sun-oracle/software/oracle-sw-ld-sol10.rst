.. index:: oracle, solaris

.. meta::
   :keywords: oracle, solaris

.. _oracle-sw-ld-sol10:

Solaris 10 on LDOMs
===================

Небольшое замечание на тему Solaris 10 и branded zone в доменах T5

.. code-block:: none

   Согласно нашего разговора пересылая наше мнение относительно использования S10 в гостевых доменах серверов T5. 
   
   1.При интенсивном виртуализированном вводе-выводе S10 показывает существенно худшие (в разы) показатели производительности. Причем результат    ввода-вывода существенно ухудшается при увеличении количества процессоров в гостевом домена. Мы открывали в Oracle кейс по этому поводу. 
   Их ответ таков: 
   >> Инженеры TSC определили наиболее вероятную причину проблемы с разницей в производительности S10 и S11 - это реализация функции bp_mapout.
   >> В S10 ядро тратит на выполнение этой функции в среднем в 20 раз больше времени, нежели в S11 по причине вызова hat_unload() и последующего вызова    hat_unload_callback() что вызывает высокий уровень xcalls. В S11 вызов bp_mapout реализован через единовременный неблокирующийся вызов    hat_kpm_paddr_mapout(), завершающийся очень быстро.
   >> Разница вызвана изменением RFE (request for enhancement) 15288596 SUNBT6328213 BP_MAPIN() SHOULD USE KPM, предложенным в 2005 и реализованным в 2007.    Изменение было призвано улучшить работу с I/O и опиралось на новыые коренные возможности Solaris 11. Обратное портирование этого изменения в Solaris 10    невозможно по причине слишком обширного изменения затронутой кодовой базы.
   Рекомендацией было использование branded zone Solaris 10, тестирование производительности в которой дало хорошие результаты. Такой вариант, кстати,    облегчает дальнейшую миграцию на S11. 
   
   2.Обходным путем также может быть отказ от мультипасинга на уровне доменов ввода-вывода (что сильно затрудняет администрирование) или использование    страйпов с большим количество в гостевых доменах. 
   
   3.В целом есть ощущение, что S10 на этих машинах работает не очень хорошо, в частности, обнаруживаются особенности поведения (или баги), которые    устраняются только в коде S11.

   -- alive